<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dashboard</title>

<style>
body{background:#0a0f1c;color:white;font-family:sans-serif;margin:0}
.topbar{display:flex;justify-content:space-between;padding:18px;background:#0f1428}
.btn{padding:10px 16px;border:none;border-radius:8px;cursor:pointer}
.support{background:#1d4ed8;color:white}
.admin{background:#111827;color:white}
.discord{background:#5865F2;color:white}
.main{padding:30px}
.card{background:#111827;padding:20px;border-radius:12px;margin-bottom:20px}
#adminArea{position:fixed;bottom:20px;right:20px;background:#020617;padding:15px;border-radius:10px;display:none}
#supportBox textarea{width:260px;height:90px;border-radius:8px;border:none;padding:8px}
</style>
</head>

<body>

<div class="topbar">
<div>ULTRA DASHBOARD</div>

<div>
<button class="btn support" onclick="openSupport()">Support</button>
<button class="btn admin" onclick="adminToggle()">Admin</button>
<button class="btn discord" onclick="window.open('https://discord.gg/ATzJaBh3xk')">Discord</button>
</div>
</div>

<div class="main">
<div class="card">
<h3>Account</h3>
<p id="accountInfo">Checking login...</p>
</div>
</div>

<div id="supportBox" style="display:none;background:#020617;padding:20px;border-radius:10px;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%)">
<h3>Support</h3>
<textarea id="supportText" placeholder="Describe your issue"></textarea><br><br>
<button onclick="generateSupport()">Create</button>
<button onclick="closeSupport()">Close</button>
<p id="supportOutput"></p>
</div>

<div id="adminArea">
<input id="cmdBox" placeholder="Type command">
<button onclick="runCmd()">Run</button>
<div id="output"></div>
</div>

<script>

/* ========= WEBHOOKS ========= */

const SUPPORT_WEBHOOK="https://discord.com/api/webhooks/1475502488781066320/PIDgCylGmkhnfIJlAFkm9CM13eSYuN03qPefXWjGWS6qMCnk1WI_ygekJY8FfqV4mYUC";
const LOG_WEBHOOK="https://discord.com/api/webhooks/1475502367402233996/9tyecTFCmYzrh4MI9QFIFUzSmu_fpFio2lIPbWv-FfFR9HmtcCgRISI05omfkA1apAe-";
const OWNER_ID="1473632317112189062";

function sendWebhook(url,msg){
fetch(url,{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({content:msg})
}).catch(()=>{});
}

function logLogin(name){
sendWebhook(LOG_WEBHOOK,`ðŸŸ¢ **Login:**\n${name} Logged to the website!`);
}

function logError(problem){
sendWebhook(LOG_WEBHOOK,`ðŸ”´ **Error:**\nThe website have (${problem})\n<@${OWNER_ID}> fix it`);
}

function sendSupportMsg(name,text){
sendWebhook(SUPPORT_WEBHOOK,
`ðŸŸ¡ **Support Request**
User: ${name}
Message: "${text}"`);
}

/* ========= DISCORD LOGIN ========= */

(function(){

if(window.location.hash.includes("access_token")){

const hash=new URLSearchParams(window.location.hash.substring(1));
const token=hash.get("access_token");

fetch("https://discord.com/api/users/@me",{
headers:{Authorization:"Bearer "+token}
})
.then(r=>r.json())
.then(user=>{

localStorage.setItem("discordUser",JSON.stringify(user));
history.replaceState({},document.title,"dashboard.html");

logLogin(user.username || "User");

loadUser();

})
.catch(()=>logError("Discord API login fetch failed"));

return;
}

loadUser();

})();

/* ========= LOAD USER ========= */

function loadUser(){

const user=JSON.parse(localStorage.getItem("discordUser")||"null");

if(!user){
logError("User session missing");
location.href="index.html";
return;
}

document.getElementById("accountInfo").innerText=
"Logged in as "+user.username+"#"+user.discriminator;

if(user.id===OWNER_ID){
document.querySelector(".admin").style.display="inline-block";
}else{
document.querySelector(".admin").style.display="none";
}

}

/* ========= MAINTENANCE ========= */

if(localStorage.getItem("siteLocked")==="true"){
document.body.innerHTML="<h1 style='margin-top:40%;text-align:center'>Website Under Maintenance</h1>";
}

/* ========= SUPPORT ========= */

function openSupport(){
document.getElementById("supportBox").style.display="block";
}

function closeSupport(){
document.getElementById("supportBox").style.display="none";
}

function generateSupport(){

let t=document.getElementById("supportText").value.trim();
if(!t)return alert("Write something");

let user=JSON.parse(localStorage.getItem("discordUser")||"null");
let name=user?.username||"Unknown";

document.getElementById("supportOutput").innerText=
'I have a report/support: "'+t+'"';

sendSupportMsg(name,t);

}

/* ========= ADMIN ========= */

function adminToggle(){
document.getElementById("adminArea").style.display="block";
}

function runCmd(){

let cmd=document.getElementById("cmdBox").value.trim();
let output=document.getElementById("output");

if(cmd==="?lockweb"){
localStorage.setItem("siteLocked","true");
location.reload();
}

else if(cmd==="?unlockweb"){
localStorage.removeItem("siteLocked");
location.reload();
}

else if(cmd.startsWith("?playsong")){
let id=cmd.split(" ")[1];
if(!id)return alert("Use ?playsong VIDEO_ID");

output.innerHTML=
`<iframe width="250" height="140"
src="https://www.youtube.com/embed/${id}"
allowfullscreen></iframe>`;
}

else if(cmd==="?checkallusersaccount"){
output.innerText=localStorage.getItem("discordUser")||"none";
}

else alert("Unknown command");

}

</script>

</body>
  </html>
