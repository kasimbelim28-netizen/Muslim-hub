import { createClient } from "@supabase/supabase-js";

const supabase = createClient(
  "https://xbwgottrnhubmpxhvkrk.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhid2dvdHRybmh1Ym1weGh2a3JrIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc3MTczMjY3MywiZXhwIjoyMDg3MzA4NjczfQ.7PlDW0uhlPTs-FTDhT2_yBj_v11Ks2vCPdOJj5dt8rU"
);

export default async function handler(req, res){

  if(req.method !== "POST"){
    return res.status(405).json({error:"Method not allowed"});
  }

  const { id, name } = req.body;

  const { error } = await supabase
    .from("users")
    .upsert([{ id, name }]);

  if(error){
    return res.status(500).json({error:error.message});
  }

  res.status(200).json({success:true});
}
